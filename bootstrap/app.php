<?php

/**
 * |--------------------------------------------------------------------------
 * | Including autoload to automagically load all classes
 * |--------------------------------------------------------------------------
 */
require __DIR__ . '/../vendor/autoload.php';

/**
 * |--------------------------------------------------------------------------
 * | Loads all environment variables
 * |--------------------------------------------------------------------------
 */
(Dotenv\Dotenv::createMutable(
    __DIR__ . '/../.'
))->load();

/**
 * |--------------------------------------------------------------------------
 * | Configure the time zone to be used.
 * |--------------------------------------------------------------------------
 */
date_default_timezone_set(env('APP_TIMEZONE'));

/**
 * |--------------------------------------------------------------------------
 * | The ErrorHandler component provides tools to manage errors and ease debugging PHP code.
 * |--------------------------------------------------------------------------
 */
if (appDebug()) {
    (Symfony\Component\ErrorHandler\Debug::enable());
}

/**
 * |--------------------------------------------------------------------------
 * | Load the defines needed to establish a connection to the datalayer
 * |--------------------------------------------------------------------------
 */
(new Snow\Database());

/**
 * |--------------------------------------------------------------------------
 * | Start safely and optimally session
 * |--------------------------------------------------------------------------
 */
(new Snow\Session());

/**
 * |--------------------------------------------------------------------------
 * | Create bladeone template engine
 * |--------------------------------------------------------------------------
 */
(new Snow\Engine());

/*
 * |--------------------------------------------------------------------------
 * | Start router http dispatcher
 * |--------------------------------------------------------------------------
 */
$router = (new Snow\Router(env('APP_URL')));

/*
 * |--------------------------------------------------------------------------
 * | Return the router dispatcher application
 * |--------------------------------------------------------------------------
 */
return $router;
